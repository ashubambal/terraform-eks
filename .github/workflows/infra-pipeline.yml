name: Infra-Pipeline

on:
    workflow_dispatch:
      inputs:
        terraform_action:
          type: choice
          description: Select Terraform action
          options:
            - apply
            - destroy
  
    push:
      branches:
        - main
        - stage

jobs:
    terraform:
        name: "Terraform"
        env:
        # AWS Secrets
          AWS_ACCESS_KEY_ID = ${{ secrets.AWS_ACCESS_KEY_ID }}
          AWS_SECRET_ACCESS_KEY = ${{ secrets.AWS_SECRET_ACCESS_KEY }}
        runs-on: ubuntu-latest
        environment: main

        steps:
        # Checkout the repository to the GitHub Action runner
        - name: Checkout
          uses: action/checkout@3
